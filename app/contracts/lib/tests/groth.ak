use types/groth.{GrothProof, SnarkVerificationKey}

test point_to_hash_to_int_list() {
  let w: ByteArray =
    #"a1588e31d17d31785a4ce1a882ca92a3f1bbb7fdd9953398ff53fca38ade891c075f9e7eefc9d1396298c6f680539c69"
  let public_ints: List<Int> = groth.public_inputs_from_w(w)
  public_ints == [
    86721980652443005217719496642694247237,
    158132697557323219579992358050637845714, 0,
  ]
}

test valid_groth_proof() {
  let vk: SnarkVerificationKey =
    SnarkVerificationKey {
      nPublic: 3,
      vkAlpha: #"8529522f913853cb8cca28f9dec0ceff18158ad532851abbfce81369496c12b160108fd4062fe6db172ba3a43c4dea53",
      vkBeta: #"a1be760d21c790df16e22d59efd6f8eb88f7d3635b177e7e9411ce209130824abf69e707a86f7cc69f05b5189fd2c38e155c86204ce8de9c15cb76388d0915e05f12bc3d3e70ab04b29b94a33563104f9c32989a37e6eab1ed69bf2a54920d58",
      vkGamma: #"a8032d32c7150929690421800d5088bc9da6567196f21de0f88aac63871e85b6429f870e06515d6ad45cf5c8a0d15f27112bbae916c73e44ad1a79829941be44766840ea82aa81cbf68f15758334a274aa15b420bd4463b38cc35b068691d36d",
      vkDelta: #"a4d3e2e2d305236189c73d88f233b94321e1d0594c3591664f762196387c8e9ba866318294dfbf24feb811c505aa52090fc03b8f562ae92d316ed4c4fc5e30252d2d6e39a07585a5e91a35e07516fec4e3a53b45567a8eace976435943f75afe",
      vkIC: [
        #"8b41618ff8eb8f9e8ca16ff08260803ad99a7a6dd3d9f718414fbbe789bb116889aef8990b32aa573863b6f00aeb5d83",
        #"a837d7e82fb7772a5eb2d991aacd624f04434a6a356ef75d6d5e677e60121c0486dc4f13af05617ba9ee5af958884085",
        #"afa63a21ee0cdc0803a7747ad1e98a5e2cb34857a9d0f77e001abefec9c719ff9cb8b55dd256a95d932ff8719a55c0d4",
        #"aad5eb711d07c990284bbda139eb965683bc9015b51dc30a2acc835e13c725deddc581cb773a2aff387a024f3d67bbac",
      ],
    }

  let pk: GrothProof =
    GrothProof {
      piA: #"a6db8db8c37f6f8d6792377c3f76a1113628e027b71b6a40c4f97e9b0cf6308098dfd6b28a8a691abb4211cea6d67bb8",
      piB: #"b3ae719a8be6ac3a20736063a92fa81f2127d4db2f6db9d3e9a617d9e5a3dc8dfc88c345f276a16b40c7d197365b3ba90e12bdcf69f9f0ef4f7b0bc9c01366b5f68cc6be74bc6329a4654ec86ca446b521f9d62dea6fe36e7ce47cf34c431d41",
      piC: #"89c5e20af4e835809ad026722b6249c713ca2880cec24a684bc11298c7f84a5d459b7c9fa9c0d02ffe6c58a0ff81260f",
    }

  let public_values: List<Int> =
    [
      86721980652443005217719496642694247237,
      158132697557323219579992358050637845714, 0,
    ]
  groth.verify_groth16(vk, pk, public_values)
}
